extends ../layout

append head
    script(type='text/javascript').
        window.onload = function() {
            $('#confirm-delete').on('show.bs.modal', function(e) {
                $(this).find('#delete-ok').attr('href', $(e.relatedTarget).data('href'));
            });
        };
        var users = !{JSON.stringify(users)};
    script(src='/javascripts/users.js')
    script(src='/javascripts/edit.js')
    script(src='/javascripts/create.js')

append body
    .container
        .alert#users-alert(role="alert" hidden)
        .panel.panel-default
            .panel-heading
                h3.panel-title Users
            div(style="margin: 10px")
                .col-md-6
                    p#num-users #[strong #{users.length}] users in the database
                .col-md-6.text-right
                    button.btn.btn-success(type='button' data-toggle="modal" data-target="#create-user")
                        span.glyphicon.glyphicon-plus
                        |  Add user
            table.table.table-bordered.table-hover#user-table
                thead
                    th ID
                    th Username
                    th First Name
                    th Last Name
                    th Roles
                    th Manage
        #create-user.modal.fade(role='dialog')
            .modal-dialog
                .modal-content
                    .modal-header
                        button.close(type='button', data-dismiss='modal') ×
                        h4.modal-title Create User
                    .modal-body
                        .alert#create-alert(role="alert" hidden)
                        form.form-horizontal#create-form(method="post")
                            h3 Personal details
                            .form-group
                                label(for="firstname").control-label.col-sm-2 First name:
                                .col-sm-10
                                    input(type="text" name="firstname").form-control#create-firstname
                            .form-group
                                label(for="lastname").control-label.col-sm-2 Last name:
                                .col-sm-10
                                    input(type="text" name="lastname").form-control#create-lastname
                            hr
                            h3 Account details
                            .form-group
                                label(for="username").control-label.col-sm-2 Username:
                                .col-sm-10
                                    input(type="text" name="username").form-control#create-username
                            .form-group
                                label(for="role").control-label.col-sm-2 Role:
                                .col-sm-10
                                    select.form-control#create-role(name="role")
                                        option#Administrator Administrator
                                        option#Teacher Teacher
                                        option#Student Student
                            hr
                            h3 Security
                            .form-group
                                label(for="password").control-label.col-sm-2 Password:
                                .col-sm-10
                                    input(type="password" name="password").form-control#create-password
                            .text-center
                                button(type="submit").btn.btn-success Create                       
        #confirm-delete.modal.fade(role='dialog')
            .modal-dialog
                .modal-content
                    .modal-header
                        button.close(type='button', data-dismiss='modal') ×
                        h4.modal-title Delete Confirmation
                    .modal-body
                        p Are you sure you want to delete this user? This action is irreversible.
                    .modal-footer
                        button.btn.btn-default(type='button', data-dismiss='modal') Cancel
                        a.btn.btn-danger.btn-ok#delete-ok Delete
        #edit-user.modal.fade(role='dialog')
            .modal-dialog
                .modal-content
                    .modal-header
                        button.close(type='button', data-dismiss='modal') ×
                        h4.modal-title Edit User
                    .modal-body
                        .alert#user-alert(role="alert" hidden)
                        form.form-horizontal#user-form(method="post")
                            h3 Personal details
                            .form-group
                                label(for="firstname").control-label.col-sm-2 First name:
                                .col-sm-10
                                    input(type="text" name="firstname").form-control#firstname
                            .form-group
                                label(for="lastname").control-label.col-sm-2 Last name:
                                .col-sm-10
                                    input(type="text" name="lastname").form-control#lastname
                            hr
                            h3 Account details
                            .form-group
                                label(for="username").control-label.col-sm-2 Username:
                                .col-sm-10
                                    input(type="text" name="username").form-control#username
                            .form-group
                                label(for="role").control-label.col-sm-2 Role:
                                .col-sm-10
                                    select.form-control#role(name="role")
                                        option#Administrator Administrator
                                        option#Teacher Teacher
                                        option#Student Student
                            .text-center
                                button(type="submit").btn.btn-default Save
                        form.form-horizontal#password-form(method="post")
                            hr
                            h3 Security
                            .alert#password-alert(role="alert" hidden)
                            .form-group
                                label(for="password").control-label.col-sm-2 Password:
                                .col-sm-10
                                    input(type="password" name="password").form-control#password
                            .text-center
                                button(type="submit").btn.btn-default Change Password
